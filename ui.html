<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    :root {
      --color-primary: #02080d;
      --color-primary-hover: #373b3d;
      --color-outline-hover: #e1e5e9;
      --color-danger: #ff5252;
      --color-danger-hover: #b71c1c;
      --color-danger-bg: #ffeaea;
      --color-border: #e1e5e9;
      --color-status-success-bg: #e8f5e8;
      --color-status-success-border: #c8e6c9;
      --color-status-success-text: #2e7d32;
      --color-status-error-bg: #ffebee;
      --color-status-error-border: #ffcdd2;
      --color-status-error-text: #c62828;
      --color-link: #338cf9;
      --color-link-hover: #2c52d1;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Inter', sans-serif; 
      font-size: 12px; 
      padding: 16px; 
      background: #eceff0;
    }
    .section { 
      background: white; 
      border-radius: 8px; 
      padding: 16px; 
      margin-bottom: 16px; 
    }
    .section-title { 
      font-weight: 600; 
      margin-bottom: 12px; 
      color: #1a1a1a;
    }
    .form-group { margin-bottom: 12px; display:flex; gap:8px; align-items:center; }
    .label { display: block; margin-bottom: 6px; font-weight: 500; color: #5f6368; font-size: 11px; }
    .input { padding: 8px; border: 1px solid var(--color-border); border-radius: 6px; font-size: 12px; font-family: inherit; }
    .headline-input { width: 100%; }
    .btn { padding: 10px 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: 12px; margin-bottom: 8px; }
    .btn-secondary { background: white; color: var(--color-primary); border: 1px solid var(--color-primary); }
    .btn-secondary:hover { background: #d3d6da; }
    .status { padding: 12px; border-radius: 6px; font-size: 11px; margin-bottom: 16px; display: none; }
    .status.success { background: var(--color-status-success-bg); color: var(--color-status-success-text); border: 1.3px solid var(--color-status-success-border); }
    .status.error { background: var(--color-status-error-bg); color: var(--color-status-error-text); border: 1.3px solid var(--color-status-error-border); }
    .btn-outline-primary { 
      width: 100%; 
      background: white; 
      color: var(--color-primary); 
      border: 1.3px solid var(--color-primary); 
      border-radius: 20px; 
      padding: 12px 16px; 
      font-weight: 600; 
      font-size: 14px; 
      transition: background 0.15s, color 0.15s, border 0.15s; 
    }
    .btn-outline-primary:hover {
      background: var(--color-outline-hover);
      color: #02080d;
      border-color: #02080d;
    }
    .btn-filled-primary {
      width: 100%;
      background: var(--color-primary);
      color: white;
      border: 1.3px solid var(--color-primary);
      border-radius: 20px;
      padding: 12px 16px;
      font-weight: 600;
      font-size: 14px;
      transition: background 0.15s, color 0.15s, border 0.15s;
    }
    .btn-filled-primary:hover {
      background: var(--color-primary-hover);
      border-color: var(--color-primary-hover);
      color: white;
    }
    .remove-pill { border: 1.3px solid var(--color-danger); color: var(--color-danger); background: white; border-radius: 20px; padding: 4px 8px; cursor: pointer; font-weight: 600; }
    .remove-pill:hover {
      background: rgba(255, 227, 233, 0.975);
      color: var(--color-danger);
      border-color: var(--color-danger);
    }
  .font-sizes-grid { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; align-items: center; }
  .size-item { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border: 1px solid var(--color-border); background: white; border-radius: 6px; justify-content: center; font-size: 13px; min-width: 56px; box-sizing: border-box; }
  .size-item input { width: 16px; height: 16px; }
  .size-item span { margin-left: 6px; }
  .size-item input { width: 16px; height: 16px; }
  .size-item span { margin-left: 4px; }
    .font-actions { margin-left: auto; font-size: 11px; color: #5f6368; display:flex; gap:8px; align-items:center; }
    .font-actions a { cursor:pointer; color:var(--color-link); text-decoration:none; }
    .add-custom-btn { float: right; }
    /* Adjust textarea to single-line input */
    #content-input { height: auto; min-height: unset; padding: 8px; }
    .headline-input { width: 100%; padding: 8px; border: 1.3px solid var(--color-border); border-radius: 6px; font-size: 12px; font-family: inherit; }
    .remove-size-btn {
      background: none;
      border: none;
      color: #b71c1c;
      font-size: 15px;
      margin-left: 4px;
      cursor: pointer;
      padding: 0 2px;
      border-radius: 3px;
      line-height: 1;
      transition: background 0.15s;
    }
    .remove-size-btn:hover {
      background: var(--color-danger-bg);
    }
    /* Custom size input and Add button styling */
    .custom-size-row input[type="number"] {
      width: 112px;
      padding: 8px 8px 8px 12px;
      border: 1.3px solid var(--color-border);
      border-radius: 20px;
      font-size: 13px;
      background: #fafbfc;
      margin-right: 0px;
      outline: none;
      transition: border 0.15s;
    }
    .custom-size-row input[type="number"]:focus {
      border: 1.5px solid #1976d2;
      background: #fff;
    }
    .add-custom-btn {
      border: 1.3px solid #1976d2;
      background: white;
      color: #1976d2;
      border-radius: 20px;
      padding: 8px 18px;
      font-weight: 600;
      font-size: 13px;
      margin: 0;
      transition: background 0.15s, color 0.15s, border 0.15s;
      box-shadow: none;
    }
    .add-custom-btn:hover {
      background: #e3f0fd;
      color: #1251a3;
      border-color: #1251a3;
    }
    /* Custom styled checkboxes for .size-item */
    .size-item input[type="checkbox"] {
      appearance: none;
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border: 1.5px solid var(--color-primary);
      border-radius: 5px;
      background: #fff;
      outline: none;
      cursor: pointer;
      position: relative;
      transition: border 0.15s, box-shadow 0.15s;
      margin: 0;
      vertical-align: middle;
    }
    .size-item input[type="checkbox"]:checked {
      background: var(--color-primary);
      border-color: var(--color-primary);
    }
    .size-item input[type="checkbox"]:checked::after {
      content: '';
      display: block;
      position: absolute;
      left: 50%;
      top: 50%;
      width: 4px;
      height: 10px;
      border: solid #fff;
      border-width: 0 2.5px 2.5px 0;
      border-radius: 1px;
      transform: translate(-50%, -55%) rotate(45deg);
    }
    .size-item input[type="checkbox"]:hover {
      box-shadow: 0 0 0 2px var(--color-outline-hover);
    }
  </style>
  <!-- Material Symbols Rounded (Google Fonts) -->
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet" />
  <style>
    .material-symbols-rounded {
      font-family: 'Material Symbols Rounded';
      font-weight: normal;
      font-style: normal;
      font-size: 20px;
      line-height: 1;
      letter-spacing: normal;
      text-transform: none;
      display: inline-block;
      white-space: nowrap;
      direction: ltr;
      -webkit-font-feature-settings: 'liga';
      font-feature-settings: 'liga';
      -webkit-font-smoothing: antialiased;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <div id="status" class="status"></div>

  <!-- Text type toggle removed: interface now collects all categories at once -->

  <div class="section">
    <div class="section-title">Headlines</div>
    <div id="headlines-container"></div>
    <div style="margin-top:12px;">
      <button class="btn-outline-primary" id="add-headline-btn">Add Headline</button>
    </div>
    <div style="margin-top:12px;">
      <div style="display:flex; align-items:center; gap:16px; margin-bottom:8px;">
        <div class="label">Font Sizes</div>
        <div class="font-actions">
          <a id="headline-select-all">Select all</a>
          <a id="headline-deselect-all">Deselect all</a>
        </div>
      </div>
      <div class="font-sizes-grid" id="font-sizes-headline"></div>
      <div class="custom-size-row" style="display:flex; justify-content:flex-end; align-items:center; gap:8px; margin-top:8px;">
        <input type="number" min="1" placeholder="Custom size" id="custom-size-headline" />
        <button class="add-custom-btn" id="add-size-headline">Add</button>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Subheadlines</div>
    <div id="subheadlines-container"></div>
    <div style="margin-top:12px;">
      <button class="btn-outline-primary" id="add-subheadline-btn">Add Subheadline</button>
    </div>
    <div style="margin-top:12px;">
      <div style="display:flex; align-items:center; gap:16px; margin-bottom:8px;">
        <div class="label">Font Sizes</div>
        <div class="font-actions">
          <a id="subheadline-select-all">Select all</a>
          <a id="subheadline-deselect-all">Deselect all</a>
        </div>
      </div>
      <div class="font-sizes-grid" id="font-sizes-subheadline"></div>
      <div class="custom-size-row" style="display:flex; justify-content:flex-end; align-items:center; gap:8px; margin-top:8px;">
        <input type="number" min="1" placeholder="Custom size" id="custom-size-subheadline" />
        <button class="add-custom-btn" id="add-size-subheadline">Add</button>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Disclaimers</div>
    <div id="disclaimers-container"></div>
    <div style="margin-top:12px;">
      <button class="btn-outline-primary" id="add-disclaimer-btn">Add Disclaimer</button>
    </div>
    <div style="margin-top:12px;">
      <div style="display:flex; align-items:center; gap:16px; margin-bottom:8px;">
        <div class="label">Font Sizes</div>
        <div class="font-actions">
          <a id="disclaimer-select-all">Select all</a>
          <a id="disclaimer-deselect-all">Deselect all</a>
        </div>
      </div>
      <div class="font-sizes-grid" id="font-sizes-disclaimer"></div>
      <div class="custom-size-row" style="display:flex; justify-content:flex-end; align-items:center; gap:8px; margin-top:8px;">
        <input type="number" min="1" placeholder="Custom size" id="custom-size-disclaimer" />
        <button class="add-custom-btn" id="add-size-disclaimer">Add</button>
      </div>
    </div>
  </div>

  <!-- Unified font sizes section removed; each category has its own controls -->

  <div class="section">
    <button class="btn-filled-primary" id="create-variants">Create as Variants</button>
  </div>

  <script>
    // Per-category font size sets (available sizes) and selection state
    const availableSizes = {
      headline: [128,120,104,96,80,72,64,56,48,36,32,24,20,16,12],
      subheadline: [80,72,64,56,48,36,32,28,24,20,18,16,14],
      disclaimer: [40,32,24,20,16,14,12,10]
    };
    const selectedSizes = {
      headline: [128,120,104,96,80,72,64,56,48,36,32,24,20],
      subheadline: [80,72,64,56,48,36,32,28,24,20,18,16,14,12],
      disclaimer: [40,32,24,20,16,14,12,10]
    };

    // Initialize
    setupEventListeners();
    renderAll();

    function setupEventListeners() {
      document.getElementById('create-variants').addEventListener('click', createVariants);

      // HEADLINES
      document.getElementById('add-headline-btn').addEventListener('click', () => appendInput('headline'));
      document.getElementById('headline-select-all').addEventListener('click', () => { selectedSizes.headline = [...availableSizes.headline]; renderSizes('headline'); });
      document.getElementById('headline-deselect-all').addEventListener('click', () => { selectedSizes.headline = []; renderSizes('headline'); });
      document.getElementById('add-size-headline').addEventListener('click', () => {
        const input = document.getElementById('custom-size-headline');
        const n = parseInt(input.value, 10);
        if (isNaN(n) || n <= 0) { input.value = ''; input.placeholder = 'Invalid'; return; }
        if (!availableSizes.headline.includes(n)) availableSizes.headline.push(n);
        if (!selectedSizes.headline.includes(n)) selectedSizes.headline.push(n);
        input.value = '';
        renderSizes('headline');
      });

      // SUBHEADLINES
      document.getElementById('add-subheadline-btn').addEventListener('click', () => appendInput('subheadline'));
      document.getElementById('subheadline-select-all').addEventListener('click', () => { selectedSizes.subheadline = [...availableSizes.subheadline]; renderSizes('subheadline'); });
      document.getElementById('subheadline-deselect-all').addEventListener('click', () => { selectedSizes.subheadline = []; renderSizes('subheadline'); });
      document.getElementById('add-size-subheadline').addEventListener('click', () => {
        const input = document.getElementById('custom-size-subheadline');
        const n = parseInt(input.value, 10);
        if (isNaN(n) || n <= 0) { input.value = ''; input.placeholder = 'Invalid'; return; }
        if (!availableSizes.subheadline.includes(n)) availableSizes.subheadline.push(n);
        if (!selectedSizes.subheadline.includes(n)) selectedSizes.subheadline.push(n);
        input.value = '';
        renderSizes('subheadline');
      });

      // DISCLAIMERS
      document.getElementById('add-disclaimer-btn').addEventListener('click', () => appendInput('disclaimer'));
      document.getElementById('disclaimer-select-all').addEventListener('click', () => { selectedSizes.disclaimer = [...availableSizes.disclaimer]; renderSizes('disclaimer'); });
      document.getElementById('disclaimer-deselect-all').addEventListener('click', () => { selectedSizes.disclaimer = []; renderSizes('disclaimer'); });
      document.getElementById('add-size-disclaimer').addEventListener('click', () => {
        const input = document.getElementById('custom-size-disclaimer');
        const n = parseInt(input.value, 10);
        if (isNaN(n) || n <= 0) { input.value = ''; input.placeholder = 'Invalid'; return; }
        if (!availableSizes.disclaimer.includes(n)) availableSizes.disclaimer.push(n);
        if (!selectedSizes.disclaimer.includes(n)) selectedSizes.disclaimer.push(n);
        input.value = '';
        renderSizes('disclaimer');
      });

      // Message handler
      window.onmessage = (event) => {
        const msg = event.data.pluginMessage;
        if (msg) handlePluginMessage(msg);
      };
    }

    // Append an input row for a given type
    function appendInput(type, value = '') {
      const container = document.getElementById(`${type}s-container`);
      const row = document.createElement('div');
      row.className = 'form-group';
      row.style.display = 'flex';
      row.style.alignItems = 'center';

      const input = document.createElement('input');
      input.type = 'text';
      input.className = `input ${type}-input`;
      input.placeholder = type === 'headline' ? 'Enter a headline...' : (type === 'subheadline' ? 'Enter a subheadline...' : 'Enter a disclaimer...');
      input.value = value;
      input.style.flex = '1';

    const remove = document.createElement('button');
    remove.className = 'remove-pill';
    remove.type = 'button';
    remove.innerHTML = '<span class="material-symbols-rounded">remove</span>';
    remove.title = 'Remove';
    remove.addEventListener('click', () => row.remove());

      row.appendChild(input);
      row.appendChild(remove);
      container.appendChild(row);
    }

    // Render size checkboxes for a type
    function renderSizes(type) {
      const container = document.getElementById(`font-sizes-${type}`);
      container.innerHTML = '';
      // Ensure unique and sorted desc
      const sizes = Array.from(new Set(availableSizes[type])).sort((a,b) => b - a);
      availableSizes[type] = sizes;

      // Store initial sizes for each type on first run
      if (!window._initialSizes) window._initialSizes = {};
      if (!window._initialSizes[type]) window._initialSizes[type] = [...sizes];

      sizes.forEach(size => {
        const item = document.createElement('label');
        item.className = 'size-item';

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = selectedSizes[type].includes(size);
        checkbox.addEventListener('change', () => {
          if (checkbox.checked) {
            if (!selectedSizes[type].includes(size)) selectedSizes[type].push(size);
          } else {
            const idx = selectedSizes[type].indexOf(size);
            if (idx !== -1) selectedSizes[type].splice(idx,1);
          }
        });

        const span = document.createElement('span');
        span.textContent = `${size}`;

        item.appendChild(checkbox);
        item.appendChild(span);

        // Add remove button for custom sizes (not in initial set)
        if (!window._initialSizes[type].includes(size)) {
          const removeBtn = document.createElement('button');
          removeBtn.type = 'button';
          removeBtn.className = 'remove-size-btn';
          removeBtn.title = 'Remove size';
          removeBtn.innerHTML = '&times;';
          removeBtn.style.marginLeft = '2px';
          removeBtn.onclick = (e) => {
            e.preventDefault();
            availableSizes[type] = availableSizes[type].filter(s => s !== size);
            selectedSizes[type] = selectedSizes[type].filter(s => s !== size);
            renderSizes(type);
          };
          item.appendChild(removeBtn);
        }

        container.appendChild(item);
      });
    }
    // addCustomSize removed: now handled inline per section

    function renderAll() {
      // Ensure at least one input row exists per category
      if (document.querySelectorAll('.headline-input').length === 0) appendInput('headline');
      if (document.querySelectorAll('.subheadline-input').length === 0) appendInput('subheadline');
      if (document.querySelectorAll('.disclaimer-input').length === 0) appendInput('disclaimer');

      renderSizes('headline');
      renderSizes('subheadline');
      renderSizes('disclaimer');
    }

    function showStatus(message, type) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.className = `status ${type}`;
      status.style.display = 'block';
      setTimeout(() => status.style.display = 'none', 4000);
    }

    function createVariants() {
      const headlines = Array.from(document.querySelectorAll('.headline-input'))
        .map(input => input.value.trim())
        .filter(item => item.length > 0);

      const subheadlines = Array.from(document.querySelectorAll('.subheadline-input'))
        .map(input => input.value.trim())
        .filter(item => item.length > 0);

      const disclaimers = Array.from(document.querySelectorAll('.disclaimer-input'))
        .map(input => input.value.trim())
        .filter(item => item.length > 0);

      if (headlines.length === 0 && subheadlines.length === 0 && disclaimers.length === 0) {
        showStatus('Please add at least one text item.', 'error');
        return;
      }

      const data = {
        headlines,
        subheadlines,
        disclaimers,
        fontSizes: {
          headline: selectedSizes.headline.slice().sort((a,b)=>b-a),
          subheadline: selectedSizes.subheadline.slice().sort((a,b)=>b-a),
          disclaimer: selectedSizes.disclaimer.slice().sort((a,b)=>b-a)
        }
      };

      parent.postMessage({ pluginMessage: { type: 'create-variants', data } }, '*');
    }

    function handlePluginMessage(msg) {
      switch (msg.type) {
        case 'success':
          showStatus(msg.message, 'success');
          break;
        case 'error':
          showStatus(msg.message, 'error');
          break;
      }
    }
  </script>
</body>
</html>